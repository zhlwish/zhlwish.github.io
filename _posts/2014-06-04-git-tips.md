---
layout: post
title: Git笔记
date: 2014-06-04 14:56:26
category: Linux
excerpt: 工作中越来越离不开<em><a href="http://git-scm.com">git</a></em>，深感<em><a href="http://git-scm.com">git</a></em>的功能强大，基本上你会用到的、你能想到的功能都可以实现。本文是笔者遇到的问题以及解决方法的汇总，希望对读者有所帮助。
---

工作中越来越离不开_[git](http://git-scm.com/)_，深感_[git](http://git-scm.com/)_的功能强大，基本上你会用到的、你能想到的功能都可以实现。本文是笔者遇到的问题以及解决方法的汇总，希望对读者有所帮助。

<script type="text/javascript">
$(document).ready(function() {
    $('.toc').toc();
});
</script>

<div class="toc"></div>

{{ content | toc_generate }}

## 设置commit message模板

将commit message写到一个文件中，然后执行：

	git config --global commit.template ~/.git.commit.template

## 将commit从一个repo移动到另一个repo

使用_git format-patch_命令会为每一个commit生成一个patch文件，然后使用_git apply_命令将生成额patch文件应用到另一个仓库：

	git format-patch <first commit SHA>~..<first commit SHA>
	git apply <path to patch>

参考：

* [git-format-patch(1) Manual Page](https://www.kernel.org/pub/software/scm/git/docs/git-format-patch.html)
* [git-apply(1) Manual Page](https://www.kernel.org/pub/software/scm/git/docs/git-apply.html)
* [Git: Move a commit between repositories](http://makandracards.com/makandra/5531-git-move-a-commit-between-repositories)

## 忽略文件夹

只需要将文件夹名称加入_.gitignore_文件即可，注意，所有子文件夹下的这个目录都会被忽略，除非

	config/  							# 忽略config/文件夹
	!configuration/config/  # 不要忽略configuration文件夹下的config文件夹

参考：

* [gitignore(5) Manual Page](https://www.kernel.org/pub/software/scm/git/docs/gitignore.html)

## _git stash_命令

_git stash_命令可以将改动暂存起来:

	$ git stash
	$ git stash pop
  $ git stash list
	$ git stash drop

查看stash中的改动：

	$ git stash show
	$ git stash show -p
	$ git stash show -p stash @{1}

参考：

* [Git: see what's in a stash without applying stash](http://stackoverflow.com/questions/10725729/git-see-whats-in-a-stash-without-applying-stash)

## push本地的某个commit

如果临时做了一个patch，只希望push这一个commit到repo中:

  $ git push <remotename> <commit SHA>:<remotebranchname>

参考：

* [git - pushing specific commit](http://stackoverflow.com/questions/3230074/git-pushing-specific-commit)

## git远程分支操作

### push本地分支到repo

在本地创建了一个分支后，需要将这个分支push到远程repo中：

  $ git push origin new_feature

### 删除远程repo中的分支

  $ git push origin :new_feature # 注意里面的冒号

参考：

* [push and delete remote branches](http://gitready.com/beginner/2009/02/02/push-and-delete-branches.html)

### 将本地分支恢复到远程仓库的HEAD状态

	$ git fetch origin
	$ git reset --hard origin/mainline
	$ git clean -f -d

其中：_-f_表示_force_，_-d_表示_clean directory_

参考：

* [Reset and sync local respository with remote branch](http://ocpsoft.org/tutorials/git/reset-and-sync-local-respository-with-remote-branch/)

### 只merge另一个分支的某个commit

使用_git cherry-pick_命令：

	$ git cherry-pick <commit SHA>

参考：

* [How to merge a specific commit in git](http://stackoverflow.com/questions/881092/how-to-merge-a-specific-commit-in-git)

## 删除还未push的commit

_HEAD~1_表示恢复到上一个版本，这里可以替换成commit的SHA值：

	$ git reset --hard HEAD~1

## 修改还未push的上一次commit

如果需要对刚刚提交到本地repo的commit进行修改：

	$ git reset --soft HEAD^
	$ do some change
	$ git add -A
	$ git commit -c ORIG_HEAD

参考：

* [How to undo the last Git commit?](http://stackoverflow.com/questions/927358/how-to-undo-the-last-git-commit)

## 生成SSH public keys

	$ ssh-keygen -t rsa

参考：

* [Set Up Git](https://help.github.com/articles/set-up-git)

## 本地分支

### 显示本地分支信息

	$ git branch
	* master

### 创建新的branch

	$ git branch testing
	$ git branch
	* master
	  testing

### 切换到新创建的branch

	$ git checkout testing
	$ git branch
	  master
	* testing

### 创建branch的同时切换到新创建的branch

	$ git checkout -b testing2
	$ git branch
	  master
	  testing
	* testing2

### 删除branch

	$ git branch -d testing
	$ git branch
	  master
	* testing2

### 合并分支

	$ git branch master
	$ git branch
	* master
	  testing2
	$ git merge testing2


参考：

* [http://gitref.org/branching/](http://gitref.org/branching/)
* [http://darrinholst.com/post/359817782](http://darrinholst.com/post/359817782)

## 修改最近一次提交的message

使用_git commit_的_--amend_参数：

  git commit --amend -m "some other message"

修改前几次提交的但是还没push到remote repository的commit的message

	$ git lg
	* 6119426 - (master) third commit (3 seconds ago by Darrin Holst)
	* b6a0a9f - we want to change this message (23 seconds ago by Darrin Holst)
	* e24b57d - first commit (37 seconds ago by Darrin Holst)

## 交互式rebase

使用_git rebase_的_-i_参数：

	$ git rebase -i HEAD~2

将在编辑器中打开：

	pick b6a0a9f we want to change this message
	pick 6119426 third commit

	# Rebase e24b57d..6119426 onto e24b57d
	#
	# Commands:
	#  p, pick = use commit
	#  e, edit = use commit, but stop for amending
	#  s, squash = use commit, but meld into previous commit

将第一个commit改成edit：

	Change “pick” to “edit” for those that you want to edit and save that file

	edit b6a0a9f we want to change this message
	pick 6119426 third commit

	# Rebase e24b57d..6119426 onto e24b57d
	#
	# Commands:
	#  p, pick = use commit
	#  e, edit = use commit, but stop for amending
	#  s, squash = use commit, but meld into previous commit

进行相应的修改：

	Now amend that commit

	$ git commit --amend -m "some other message"

接着继续rebase操作：

	$ git rebase --continue
	$ git lg
	* cec3fba - (master) third commit (2 seconds ago by Darrin Holst)
	* c146f90 - some other message (29 seconds ago by Darrin Holst)
	* e24b57d - first commit (5 minutes ago by Darrin Holst)
